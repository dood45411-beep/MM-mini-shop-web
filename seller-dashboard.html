<!DOCTYPE html>
<html lang="my">
<head>
  <meta charset="UTF-8" />
  <title>Seller Dashboard - MM Mini Shop</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      font-family: 'Myanmar3', sans-serif;
      background-color: #e8f6f3;
      padding: 20px;
    }
    h2, h3 {
      text-align: center;
      color: #27ae60;
    }
    form {
      max-width: 400px;
      margin: 0 auto 30px auto;
      background: white;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    input, textarea {
      width: 100%;
      padding: 10px;
      margin: 8px 0;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 15px;
    }
    button {
      background-color: #27ae60;
      color: white;
      border: none;
      padding: 12px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      width: 100%;
      margin-top: 10px;
    }
    button:hover {
      background-color: #1e8449;
    }
    .product-list {
      max-width: 600px;
      margin: 0 auto 40px auto;
    }
    .product-item {
      background: white;
      border-radius: 10px;
      margin-bottom: 15px;
      padding: 15px;
      box-shadow: 0 1px 5px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    .product-item img {
      max-width: 100px;
      max-height: 100px;
      border-radius: 8px;
      float: right;
      margin-left: 15px;
      object-fit: cover;
    }
    .other-seller-product {
      background-color: #fff9c4;
    }
  </style>
</head>
<body>
  <h2>ğŸ›’ Seller Dashboard</h2>
  <form id="productForm">
    <input type="text" id="productTitle" placeholder="á€•á€…á€¹á€…á€Šá€ºá€¸á€¡á€™á€Šá€º" required />
    <input type="number" id="productPrice" placeholder="á€ˆá€±á€¸á€”á€¾á€¯á€”á€ºá€¸ (á€€á€»á€•á€º)" required />
    <input type="file" id="productPhoto" accept="image/*" required />
    <textarea id="productDescription" placeholder="á€–á€±á€¬á€ºá€•á€¼á€á€»á€€á€º (á€¡á€•á€­á€¯á€¡á€á€»á€€á€ºá€¡á€œá€€á€º)" rows="3"></textarea>
    <button type="submit">á€•á€…á€¹á€…á€Šá€ºá€¸á€¡á€á€…á€ºá€‘á€Šá€·á€ºá€™á€šá€º</button>
  </form>

  <div class="product-list" id="productList">
    <!-- á€€á€­á€¯á€šá€ºá€•á€­á€¯á€„á€º á€•á€…á€¹á€…á€Šá€ºá€¸á€á€½á€± -->
  </div>

  <div id="otherSellerProductsContainer">
    <!-- á€¡á€á€¼á€¬á€¸á€›á€±á€¬á€„á€ºá€¸á€á€°á€™á€»á€¬á€¸á€•á€…á€¹á€…á€Šá€ºá€¸á€™á€»á€¬á€¸ á€’á€®á€™á€¾á€¬ -->
  </div>

  <script>
    const sellerPhone = localStorage.getItem('currentSeller');
    if (!sellerPhone) {
      alert('Seller á€™á€á€­á€›á€¾á€­á€•á€«á‹ Login á€•á€¼á€”á€ºá€œá€¯á€•á€ºá€•á€«á‹');
      window.location.href = 'seller-login.html';
    }

    const productStorageKey = 'products_' + sellerPhone;

    const productForm = document.getElementById('productForm');
    const productList = document.getElementById('productList');
    const otherSellerProductsContainer = document.getElementById('otherSellerProductsContainer');

    productForm.addEventListener('submit', function(event) {
      event.preventDefault();

      const title = document.getElementById('productTitle').value.trim();
      const price = document.getElementById('productPrice').value.trim();
      const description = document.getElementById('productDescription').value.trim();
      const photoFile = document.getElementById('productPhoto').files[0];

      if (!title || !price || !photoFile) {
        alert('á€¡á€™á€Šá€ºáŠ á€ˆá€±á€¸á€”á€¾á€¯á€”á€ºá€¸á€”á€¾á€„á€·á€º á€•á€¯á€¶á€á€…á€ºá€•á€¯á€¶ á€œá€­á€¯á€¡á€•á€ºá€•á€«á€á€šá€ºá‹');
        return;
      }

      const reader = new FileReader();
      reader.onload = function(e) {
        const photoData = e.target.result;

        let products = JSON.parse(localStorage.getItem(productStorageKey) || '[]');
        products.push({
          title: title,
          price: price,
          description: description,
          photo: photoData,
          timestamp: new Date().toISOString()
        });

        localStorage.setItem(productStorageKey, JSON.stringify(products));
        alert('á€•á€…á€¹á€…á€Šá€ºá€¸á€¡á€á€…á€ºá€‘á€Šá€·á€ºá€•á€¼á€®á€¸á€•á€«á€•á€¼á€®á‹');
        productForm.reset();
        loadProducts();
      };
      reader.readAsDataURL(photoFile);
    });

    function loadProducts() {
      let products = JSON.parse(localStorage.getItem(productStorageKey) || '[]');
      productList.innerHTML = '<h3>á€€á€­á€¯á€šá€ºá€•á€­á€¯á€„á€º á€•á€…á€¹á€…á€Šá€ºá€¸á€™á€»á€¬á€¸</h3>';

      if (products.length === 0) {
        productList.innerHTML += '<p style="text-align:center;">á€•á€…á€¹á€…á€Šá€ºá€¸á€™á€›á€¾á€­á€á€±á€¸á€•á€«á‹</p>';
        return;
      }

      products.forEach((p) => {
        const div = document.createElement('div');
        div.className = 'product-item';
        div.innerHTML = `
          <strong>${p.title}</strong><br>
          ğŸ’° ${p.price} á€€á€»á€•á€º<br>
          <img src="${p.photo}" alt="${p.title}" />
          <p>${p.description}</p>
        `;
        productList.appendChild(div);
      });
    }

    function loadOtherSellersProducts() {
      const allKeys = Object.keys(localStorage);
      otherSellerProductsContainer.innerHTML = '<h3>á€¡á€á€¼á€¬á€¸ á€›á€±á€¬á€„á€ºá€¸á€á€°á€™á€»á€¬á€¸ á€á€„á€ºá€‘á€¬á€¸á€á€±á€¬ á€•á€…á€¹á€…á€Šá€ºá€¸á€™á€»á€¬á€¸</h3>';

      let foundAny = false;

      allKeys.forEach(key => {
        if (key.startsWith('products_') && key !== productStorageKey) {
          const products = JSON.parse(localStorage.getItem(key) || '[]');
          if (products.length > 0) {
            foundAny = true;
            products.forEach(p => {
              const div = document.createElement('div');
              div.className = 'product-item other-seller-product';
              div.innerHTML = `
                <strong>${p.title}</strong><br>
                ğŸ’° ${p.price} á€€á€»á€•á€º<br>
                <img src="${p.photo}" alt="${p.title}" />
                <p>${p.description}</p>
              `;
              otherSellerProductsContainer.appendChild(div);
            });
          }
        }
      });

      if (!foundAny) {
        otherSellerProductsContainer.innerHTML += '<p style="text-align:center;">á€¡á€á€¼á€¬á€¸á€›á€±á€¬á€„á€ºá€¸á€á€°á€™á€»á€¬á€¸á€™á€¾ á€•á€…á€¹á€…á€Šá€ºá€¸á€™á€›á€¾á€­á€á€±á€¸á€•á€«á‹</p>';
      }
    }

    window.onload = function() {
      loadProducts();
      loadOtherSellersProducts();
    };
  </script>
</body>
</html>